"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[38],{1400:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var i=t(4848),o=t(8453);const s={sidebar_position:2,title:"Development"},l=void 0,a={id:"development",title:"Development",description:"The following guide is intended to help developers who maintain or want to make changes to the Kugelblitz.",source:"@site/docs/development.mdx",sourceDirName:".",slug:"/development",permalink:"/docs/development",draft:!1,unlisted:!1,editUrl:"https://github.com/paion-data/Kugelblitz/tree/master/docs/docs/development.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"Development"},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/docs/intro"}},r={},d=[{value:"Preparing for Local Development",id:"preparing-for-local-development",level:2},{value:"Installing Java &amp; Maven (on Mac)",id:"installing-java--maven-on-mac",level:3},{value:"Installing Docker Engine",id:"installing-docker-engine",level:3},{value:"Getting Source Code",id:"getting-source-code",level:2},{value:"Syncing up with Kugelblitz&#39;s Code Styles with IntelliJ",id:"syncing-up-with-kugelblitzs-code-styles-with-intellij",level:3},{value:"Running Tests",id:"running-tests",level:2},{value:"ArangoDB",id:"arangodb",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"IntelliJ",id:"intellij",level:3},{value:"IntelliJ Cannot READ Resource File",id:"intellij-cannot-read-resource-file",level:4},{value:"Tab Width",id:"tab-width",level:4}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"The following guide is intended to help developers who maintain or want to make changes to the Kugelblitz."}),"\n",(0,i.jsx)(n.h2,{id:"preparing-for-local-development",children:"Preparing for Local Development"}),"\n",(0,i.jsx)(n.p,{children:"This section discusses the one-time setup in order to develop FastWS."}),"\n",(0,i.jsx)(n.h3,{id:"installing-java--maven-on-mac",children:"Installing Java & Maven (on Mac)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"brew update\nbrew install openjdk@17\n"})}),"\n",(0,i.jsx)(n.p,{children:"At the end of the last command prompt, something like the below will show up:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'For the system Java wrappers to find this JDK, symlink it with\n  sudo ln -sfn ...openjdk@17/libexec/openjdk.jdk .../JavaVirtualMachines/openjdk-17.jdk\n\nopenjdk@17 is keg-only, which means it was not symlinked into /usr/local,\nbecause this is an alternate version of another formula.\n\nIf you need to have openjdk@17 first in your PATH, run:\n  echo \'export PATH=".../openjdk@17/bin:$PATH"\' >> .../.bash_profile\n\nFor compilers to find openjdk@17 you may need to set:\n  export CPPFLAGS="-I.../openjdk@17/include"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Make sure to execute the ",(0,i.jsx)(n.code,{children:"sudo ln -sfn"}),", ",(0,i.jsx)(n.code,{children:"echo 'export PATH=..."}),", and the ",(0,i.jsx)(n.code,{children:"export CPPFLAGS="})," commands above"]}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsxs)(n.p,{children:["Kugelblitz is built using maven, which uses a separate JDK version. This can be seen via ",(0,i.jsx)(n.code,{children:"mvn -v"}),". If it's not JDK 17, we\nshould have Maven point to our JDK 17 using ",(0,i.jsx)(n.a,{href:"https://stackoverflow.com/a/2503679",children:"JAVA_HOME"}),":"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ /usr/libexec/java_home\n/Library/Java/JavaVirtualMachines/jdk-17.jdk/Contents/Home\n\n$ export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk-17.jdk/Contents/Home\n"})})]}),"\n",(0,i.jsx)(n.p,{children:"If we see something similar after typing the command with the version flag below we're good to go"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ java --version\nopenjdk 17.0.10 2021-01-19\nOpenJDK Runtime Environment (build 17.0.10+9)\nOpenJDK 64-Bit Server VM (build 17.0.10+9, mixed mode)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"installing-docker-engine",children:"Installing Docker Engine"}),"\n",(0,i.jsxs)(n.p,{children:["Entity WS has\n",(0,i.jsx)(n.a,{href:"https://github.com/paion-data/kugelblitz/blob/master/src/test/java/org/paiondata/ws/entity/arango/ArangoControllerIT.java",children:"Docker-based integration tests"}),";\nit also supports\n",(0,i.jsx)(n.a,{href:"https://github.com/paion-data/kugelblitz/blob/master/src/test/java/org/paiondata/ws/entity/DockerComposeIT.java",children:"running template webserivce in Docker"}),".\nDocker can be installed by following ",(0,i.jsx)(n.a,{href:"https://docs.docker.com/desktop/setup/install/mac-install/",children:"this instruction"})]}),"\n",(0,i.jsx)(n.h2,{id:"getting-source-code",children:"Getting Source Code"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git clone git@github.com:paion-data/Kugelblitz.git\ncd Kugelblitz\n"})}),"\n",(0,i.jsx)(n.h3,{id:"syncing-up-with-kugelblitzs-code-styles-with-intellij",children:"Syncing up with Kugelblitz's Code Styles with IntelliJ"}),"\n",(0,i.jsxs)(n.p,{children:["For the moment, we have distilled the most important code style conventions with respect to Kugelblitz's code as IntelliJ\nsettings. If IntelliJ is used for IDE, we may import these code style settings by importing the\n",(0,i.jsx)(n.a,{href:"http://github.com/paion-data/.github/blob/master/intellij/Paion-Data-WS-Project-intellij-code-style.xml",children:"Paion-Data-WS-Project-intellij-code-style.xml"}),'\nfile in the root of the repo. The setting for the project will appear as a new Scheme named "Paion-Data-Project" under\nIDE\'s ',(0,i.jsx)(n.strong,{children:"Editor"})," -> ",(0,i.jsx)(n.strong,{children:"Code Style"})," section."]}),"\n",(0,i.jsxs)(n.p,{children:['Please also enable "remove unused imports" by ',(0,i.jsx)(n.strong,{children:"Editor"})," -> ",(0,i.jsx)(n.strong,{children:"General"})," -> ",(0,i.jsx)(n.strong,{children:"Auto Import"})," -> ",(0,i.jsx)(n.strong,{children:"Optimize Imports on the\nFly"}),", which will automatically remove unused imports."]}),"\n",(0,i.jsx)(n.h2,{id:"running-tests",children:"Running Tests"}),"\n",(0,i.jsx)(n.p,{children:"The following commands runs both unit and integration tests:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mvn clean verify\n"})}),"\n",(0,i.jsx)(n.h2,{id:"arangodb",children:"ArangoDB"}),"\n",(0,i.jsx)(n.p,{children:"Spin up an Arango database"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"docker run -d -p 8529:8529 \\\n       -e ARANGO_ROOT_PASSWORD=root \\\n       -v arango-data:/var/lib/arangodb3 \\\n       -v arango-app:/var/lib/arangodb3-apps \\\n       --name arangodb --platform linux/arm64/v8 arangodb\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ArangoDB Web console should be accessible at ",(0,i.jsx)(n.a,{href:"http://localhost:8529",children:"http://localhost:8529"})," with the username and password being ",(0,i.jsx)(n.code,{children:"root"})," and\n",(0,i.jsx)(n.code,{children:"root"}),", respectively."]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["For more documentation on navigating the Arango Web UI, please refer to\n",(0,i.jsx)(n.a,{href:"https://arango.paion-data.dev/stable/components/web-interface/",children:"ArangoDB documentation"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"git clone git@github.com:paion-data/Kugelblitz.git\ncd Kugelblitz\nmvn clean package\n\nexport KUGELBLITZ_ARANGO_HOSTS=http://localhost:8529\nexport KUGELBLITZ_ARANGO_USERNAME=root\nexport KUGELBLITZ_ARANGO_PASSWORD=root\n\njava -jar target/kugelblitz-0.0.1-SNAPSHOT.jar\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Note that the ",(0,i.jsx)(n.code,{children:"KUGELBLITZ_ARANGO_USERNAME"})," and the ",(0,i.jsx)(n.code,{children:"KUGELBLITZ_ARANGO_PASSWORD"})," is in accordance with the ArandoDB Docker\nconfiguration above. In addition, ",(0,i.jsx)(n.code,{children:"KUGELBLITZ_ARANGO_HOSTS"}),' must start with either "',(0,i.jsx)(n.strong,{children:"http://"}),'" or "',(0,i.jsx)(n.strong,{children:"https://"}),'"']}),"\n",(0,i.jsx)(n.p,{children:"The default port is 8080."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Healthcheck: ",(0,i.jsx)(n.a,{href:"http://localhost:8080/actuator/health",children:"http://localhost:8080/actuator/health"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Swagger UI: ",(0,i.jsx)(n.a,{href:"http://localhost:8080/swagger-ui/index.html",children:"http://localhost:8080/swagger-ui/index.html"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Creating an entity:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"curl --location 'localhost:8080/arango/createDocument/mydatabase/mycollection' --header 'Content-Type: application/json' --data '{\n    \"myfield\": \"myvalue\"\n}' -v\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(n.h3,{id:"intellij",children:"IntelliJ"}),"\n",(0,i.jsx)(n.h4,{id:"intellij-cannot-read-resource-file",children:"IntelliJ Cannot READ Resource File"}),"\n",(0,i.jsx)(n.p,{children:'We sometimes see errors when we run unit tests in IntelliJ, saying "some resource file" cannot be found. We know the\npath is absolutely right. If this is the case, it\'s simply a IntelliJ issue which is solved by simply loading those\nresources explicitly by telling IntelliJ where those resources are:'}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Error loading intelliJ-find-resource.png",src:t(1878).A+"",width:"2542",height:"1600"})}),"\n",(0,i.jsx)(n.h4,{id:"tab-width",children:"Tab Width"}),"\n",(0,i.jsxs)(n.p,{children:["We use 4-space as tab. This can be configured at ",(0,i.jsx)(n.strong,{children:"Code Style"})," -> ",(0,i.jsx)(n.strong,{children:"Java"})," -> ",(0,i.jsx)(n.strong,{children:"Tabs and Indents"})," with the following\nsettings:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Tab size: 4"}),"\n",(0,i.jsx)(n.li,{children:"Indent: 4"}),"\n",(0,i.jsx)(n.li,{children:"Continuation indent: 8"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"If tabs still come out at 2 spaces when hitting TAB or Enter, not 4 spaces, try:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:'"Settings | Editor | Code Style" -- try disabling "Detect and use existing file indents for editing" in case if you\nhave it enabled (it is by default). NOTE: re-opening file in editor may be required.'}),"\n",(0,i.jsx)(n.li,{children:'Do you have any .editorconfig files anywhere in the path of that file? Settings from .editorconfig\n("Settings | Editor | Code Style") have priority (will overwrite) over your IDE settings.'}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},1878:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/intelliJ-find-resource-3f94d06504aac240f01fcde613894835.png"},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>a});var i=t(6540);const o={},s=i.createContext(o);function l(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);